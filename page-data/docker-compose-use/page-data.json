{"componentChunkName":"component---src-templates-post-template-js","path":"/docker-compose-use/","result":{"data":{"post":{"id":"4e433ebd-1571-56fa-a744-d771368b0329","html":"<h3>1. docker image ì‚¬ìš©í•˜ê¸°</h3>\n<ul>\n<li>\n<p>docker hub ì— ìˆëŠ” image ë¥¼ ë°›ì•„ì„œ ì‚¬ìš©</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">docker container run -d  -p <span class=\"token number\">15432</span>:5432 --name <span class=\"token string\">\"postgres\"</span> -e <span class=\"token assign-left variable\">POSTGRES_PASSWORD</span><span class=\"token operator\">=</span>postgres postgis/postgis:12-master</code></pre></div>\n</li>\n<li>\n<p>ë¬¸ì œì </p>\n<ul>\n<li>ë¦¬ëˆ…ìŠ¤ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë˜ wget, unzip, clear ëª…ë ¹ ë“±ì´ ì—†ì–´ì„œ ì„¤ì¹˜í•´ì¤˜ì•¼ í•œë‹¤.</li>\n<li>ìœ„ ì´ë¯¸ì§€ëŠ” postgis ë§Œì„ ìœ„í•œ image ì´ë¯€ë¡œ ë‹¤ë¥¸ ê²ƒì„ ì‚¬ìš© í•˜ë ¤ë©´ ìš©ë„ì— ë§ëŠ” ì´ë¯¸ì§€ë¥¼ ë³„ë„ì˜ container ë¡œ ì‹¤í–‰ì‹œì¼œì•¼ í•œë‹¤.</li>\n<li>í•„ìš”ì— ë”°ë¼ n ê°œì˜ container ë¥¼ ìƒì„± ë° ì‹¤í–‰í•˜ê³  ê°ê° ê´€ë¦¬í•´ì•¼í•˜ëŠ” ë¶ˆí¸í•¨ì´ ìˆë‹¤.</li>\n</ul>\n</li>\n</ul>\n<h3>2. docker image ì— ëª½ë•… ë„£ì–´ ì‚¬ìš©í•˜ê¸°</h3>\n<ul>\n<li>\n<p>centos image ë¥¼ ë°›ì•„ì„œ ê±°ê¸°ì— db, tomcat, java, rabbitmq ë“±ì„ ëª½ë•… ì„¤ì¹˜í•´ì„œ image ë¡œ ë°°í¬ í•´ì„œ ì‚¬ìš©</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">docker container run --privileged  -d -p <span class=\"token number\">15432</span>:5432 -p <span class=\"token number\">18080</span>:8080 -v <span class=\"token string\">\"D:\\data\\geoserver\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"/data/geoserver_data\"</span> --name <span class=\"token string\">\"mago3d\"</span> gaia3d/mago3d /sbin/init</code></pre></div>\n</li>\n<li>\n<p>ë¬¸ì œì </p>\n<ul>\n<li>ê°œë°œê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” db ìŠ¤í‚¤ë§ˆ ë³€ê²½ ë° í™˜ê²½ êµ¬ì„±ì„ í•­ìƒ ìµœì‹ ìœ¼ë¡œ ìœ ì§€í•˜ê¸°ê°€ ì‰½ì§€ ì•Šë‹¤.</li>\n<li>centos image ìœ„ì— ëª¨ë“  ê²ƒì„ ì„¤ì¹˜í•´ì„œ ë°°í¬í•˜ê¸° ë•Œë¬¸ì— ìš©ëŸ‰ì´ í¬ë‹¤.</li>\n<li>privileged ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•˜ë©´ì„œ container ì— ë¶ˆí•„ìš”í•œ íŒŒì¼ë“¤ì´ ëŠ˜ì–´ë‚˜ ìš©ëŸ‰ì´ ì¦ê°€í•œë‹¤.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5ca11d87624d139d177d844cb2c9a43a/c56af/docker-size.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 56.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABfklEQVR42o1Sy3KCQBDci0XAB1gCgiiiKIqo4KP0llP+/5c601tZQqxUJYeueTA709ODqi8XFHGMj8UCzXSKUvxG/Mz3kSQJppKjDYIAs9kM8/lc+2EYIooiBPI9n0xQy7t3ead2ux1WqxWq9RqpNIlHIySeh3AwgNPvo/+CgeR/y1mWpYepsiyRZRliYeGOx7AcB28C+6vwPxgOh98NyZANI6HuC3XPdeEJQ1eYcrojzf/CD4bb7RZFUYBM6e/3e5zPZ201c9GGehHUjqCuxvdFJoIs0zSF4kPicDi09nq9oq5rjYscjfZ4PLaoqkoPZZ4+CS3kIGu5g27IBBsZhozJjsfK8xybzaYFY4K1jNlkuVzqi7Ner0xwZYITqQV1oT62bWt0/S6Yp9a9Xk//XqrbiKuaFY2mhhWZGJb0CW7BVYmJHJSx6hYbjczap9Op1ZYDaPlXGBJ8w0MQZMq11e1208zu9zuezycej4eO2ZjCN03THugVrDGD+Ddw2CfsECagqKKGrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"docker-size\"\n        title=\"\"\n        src=\"/static/5ca11d87624d139d177d844cb2c9a43a/5a190/docker-size.png\"\n        srcset=\"/static/5ca11d87624d139d177d844cb2c9a43a/772e8/docker-size.png 200w,\n/static/5ca11d87624d139d177d844cb2c9a43a/e17e5/docker-size.png 400w,\n/static/5ca11d87624d139d177d844cb2c9a43a/5a190/docker-size.png 800w,\n/static/5ca11d87624d139d177d844cb2c9a43a/c1b63/docker-size.png 1200w,\n/static/5ca11d87624d139d177d844cb2c9a43a/c56af/docker-size.png 1231w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n</li>\n</ul>\n<h3>3. docker compose ë¥¼ ì‚¬ìš©í•´ì„œ ê°œì„ í•˜ê¸°</h3>\n<ul>\n<li>í•„ìš”í•œ í™˜ê²½ êµ¬ì„±ì„ Dockerfile ì— ì‘ì„±í•˜ê³  docker compose ë¥¼ ì´ìš©í•´ì„œ ê´€ë¦¬í•˜ê¸°</li>\n</ul>\n<h4>3.1. postgresql</h4>\n<ul>\n<li>postgis image ì— íƒ€ì„ì¡´, ë””ë¹„ëª…, ìœ ì €, íŒ¨ìŠ¤ì›Œë“œ ì¸ì½”ë”©, í—ˆìš©ip ë¥¼ ì„¤ì •í•´ì¤€ë‹¤. ë””ë¹„ëª…ì€ ë³€ìˆ˜ë¡œ ì§€ì •í•œ ì´ë¦„ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ë‹¤.</li>\n<li>\n<p>shell, vim ì˜ ê°€ë…ì„±ì„ ìœ„í•œ ì„¤ì •íŒŒì¼ì„ ë³µì‚¬í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> postgis/postgis:12-master</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> .vimrc /root/.vimrc</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> bashrc /color-config</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> TZ=Asia/Seoul</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> POSTGRES_DB=oim</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> POSTGRES_USER=postgres</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> POSTGRES_PASSWORD=postgres</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> POSTGRES_INITDB_ARGS=<span class=\"token string\">\"--encoding=UTF-8\"</span></span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> ALLOW_IP_RANGE=0.0.0.0/0</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> <span class=\"token operator\">\\</span>\n    apt-get update &amp;&amp; <span class=\"token operator\">\\</span>\n    apt-get install -y vim &amp;&amp; <span class=\"token operator\">\\</span>\n    cat color-config >> /etc/bash.bashrc</span></code></pre></div>\n</li>\n</ul>\n<h4>3.2. geoserver</h4>\n<ul>\n<li>tomcat image ì— geoserver war ë¥¼ ë°›ì•„ì„œ ì••ì¶•ì„ í’€ê³  cors ì„¤ì •ì„ í•´ì¤€ë‹¤.</li>\n<li>\n<p>setenv íŒŒì¼ì„ ë³µì‚¬í•˜ì§€ ì•Šê³  ENV ë¡œ geoserver ë°ì´í„° ê²½ë¡œë‚˜ ìºì‹œ ê²½ë¡œë¥¼ ì„¤ì • í•´ì¤„ ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> tomcat:9.0.38-jdk11-adoptopenjdk-openj9</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> JAVA_OPTS=-D-Xms4096m-Xmx4096m</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> <span class=\"token operator\">\\</span>\n    apt-get update &amp;&amp; <span class=\"token operator\">\\</span>\n    apt-get install -y vim wget unzip &amp;&amp; <span class=\"token operator\">\\</span>\n    rm -rf /usr/local/tomcat/webapps/* &amp;&amp; <span class=\"token operator\">\\</span>\n    cd /tmp &amp;&amp; wget http://sourceforge.net/projects/geoserver/files/GeoServer/2.17.3/geoserver-2.17.3-war.zip &amp;&amp; <span class=\"token operator\">\\</span>\n    unzip /tmp/geoserver-2.17.3-war.zip -d /usr/local/tomcat/webapps &amp;&amp; <span class=\"token operator\">\\</span>\n    rm -rf /tmp/geoserver-2.17.3-war.zip</span>\n\n<span class=\"token comment\"># Enable CORS</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> sed -i <span class=\"token string\">'\\:&lt;/web-app>:i\\\n&lt;filter>\\n\\\n    &lt;filter-name>CorsFilter&lt;/filter-name>\\n\\\n    &lt;filter-class>org.apache.catalina.filters.CorsFilter&lt;/filter-class>\\n\\\n    &lt;init-param>\\n\\\n        &lt;param-name>cors.allowed.origins&lt;/param-name>\\n\\\n        &lt;param-value>*&lt;/param-value>\\n\\\n    &lt;/init-param>\\n\\\n    &lt;init-param>\\n\\\n        &lt;param-name>cors.allowed.methods&lt;/param-name>\\n\\\n        &lt;param-value>GET,POST,HEAD,OPTIONS,PUT&lt;/param-value>\\n\\\n    &lt;/init-param>\\n\\\n&lt;/filter>\\n\\\n&lt;filter-mapping>\\n\\\n    &lt;filter-name>CorsFilter&lt;/filter-name>\\n\\\n    &lt;url-pattern>/*&lt;/url-pattern>\\n\\\n&lt;/filter-mapping>'</span> /usr/local/tomcat/conf/web.xml</span></code></pre></div>\n</li>\n</ul>\n<h4>3.3. rabbitmq</h4>\n<ul>\n<li>rabbitmq ì˜ ê´€ë¦¬ì í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ê¸°ë³¸ rabbitmq ê°€ ì•„ë‹Œ rabbitmq-management image ë¥¼ ì‚¬ìš©í•œë‹¤.</li>\n<li>\n<p>rabbitmq ì—ì„œ ì‚¬ìš©í•  ì‚¬ìš©ìì™€ queue ë“±ì„ ë¯¸ë¦¬ ì‘ì„±í•´ë‘” json íŒŒì¼ì„ image ì— ë³µì‚¬í•´ì„œ ë¹Œë“œí•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> rabbitmq:3.8.9-management</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> definitions.json /etc/rabbitmq/</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apt-get update &amp;&amp; apt-get install -y vim</span></code></pre></div>\n</li>\n</ul>\n<h4>3.4. docker-compose</h4>\n<ul>\n<li>ì´ˆê¸° í•œë²ˆì€ ëª¨ë“  Dockerfile ì„ ë¹Œë“œí•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³ , ë³€ë™ ê°€ëŠ¥ì„±ì´ ì ì€ geoserver, rabbitmq ë“±ì€ ë§Œë“¤ì–´ì§„ image ë¥¼ docker hub ì— ë“±ë¡í•˜ì—¬ í•´ë‹¹ image ë¥¼ ì‚¬ìš©í•œë‹¤.</li>\n<li>geoserver, rabbitmq ë“±ì˜ ë²„ì „ì„ ë³€ê²½í•˜ê±°ë‚˜ Dockerfile ì— ë³€ê²½ì‚¬í•­ì´ ìˆì„ ê²½ìš°ì—ëŠ” ì£¼ì„ëœ build ë¶€ë¶„ì„ í•´ì œí•˜ê³  image ë¥¼ ì£¼ì„í•˜ê³  ì‹¤í–‰í•˜ë©´ ëœë‹¤.</li>\n<li>db ëŠ” docker-entrypoint-initdb.d ê²½ë¡œì— ìŠ¤í¬ë¦½íŠ¸ë‚˜ sql ì„ ë³µì‚¬í•´ë‘ë©´ container ê°€ ì‹¤í–‰ë˜ë©´ì„œ í•´ë‹¹ ë‚´ìš©ë“¤ì„ ì‹¤í–‰ì‹œì¼œì¤€ë‹¤.</li>\n<li>\n<p>geoserver ì— ë§ˆìš´íŠ¸í•˜ëŠ” ë³¼ë¥¨ì€ docker ë‚´ë¶€ì—ì„œ ìë™ìœ¼ë¡œ ê´€ë¦¬í•˜ë„ë¡ í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\">version: '3'\nvolumes:\n  oim-geoserver-data:\n\nservices:\n  db:\n    container_name: oim-db\n    restart: always\n    build:\n      context: ./doc/docker/postgres\n      dockerfile: Dockerfile\n    volumes:\n      - ./doc/database:/database:ro\n      - ./init-user-db.sh:/docker-entrypoint-initdb.d/init-user-db.sh:ro\n    ports:\n      - 15432:5432\n      - 18080:8080\n\n  geoserver:\n    container_name: oim-geoserver\n    restart: always\n    image: gaia3d/geoserver:oim-2.17.3\n<span class=\"token comment\">#    build:</span>\n<span class=\"token comment\">#      context: ./doc/docker/geoserver</span>\n<span class=\"token comment\">#      dockerfile: Dockerfile</span>\n    volumes:\n      - oim-geoserver-data:/geoserver-data\n    network_mode: \"service:db\"\n\n  rabbitmq:\n    container_name: oim-rabbitmq\n    restart: always\n    image: gaia3d/rabbitmq:oim-3.8.9\n<span class=\"token comment\">#    build:</span>\n<span class=\"token comment\">#      context: ./doc/docker/rabbitmq</span>\n<span class=\"token comment\">#      dockerfile: Dockerfile</span>\n    ports:\n      - 5672:5672\n      - 15672:15672</code></pre></div>\n</li>\n</ul>\n<h4>3.5. ì‹¤í–‰í•˜ê¸°</h4>\n<ul>\n<li>docker-compose.yml íŒŒì¼ì´ ìˆëŠ” ê²½ë¡œì—ì„œ ë‹¤ìŒ ì‹¤í–‰</li>\n<li>\n<p>-d ëŠ” ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•œë‹¤ëŠ” ì˜µì…˜ì´ê³ , container ê°€ ìƒì„±ë˜ê³  ìœ„ì—ì„œ ì„¤ì •í•œ compose íŒŒì¼ì— restart ê°€ always ë¡œ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ, ê°œë°œì¥ë¹„ê°€ ì¬ë¶€íŒ… ë˜ì–´ë„ ìë™ìœ¼ë¡œ ì‹¤í–‰ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">docker-compose up -d</code></pre></div>\n</li>\n</ul>\n<h4>3.6. ë³€ê²½ëœ db ë°˜ì˜í•˜ê¸°</h4>\n<ul>\n<li>\n<p>-v ì˜µì…˜ì„ ì¤˜ì•¼ docker ì—ì„œ ì‚¬ìš©í•˜ëŠ” volume(geoserver-data) ì´ ëª¨ë‘ ì‚­ì œëœë‹¤. geoserver ì˜ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ê³  ì‹¶ì„ ê²½ìš°ì—ëŠ” -v ì˜µì…˜ì„ ìƒëµí•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">docker-compose down -v\ndocker-compose up --build -d</code></pre></div>\n</li>\n</ul>\n<h4>3.7. geoserver docker ì—ì„œ í˜¸ìŠ¤íŠ¸ì˜ íŒŒì¼ ì‚¬ìš©í•˜ê¸°</h4>\n<ul>\n<li>docker-compose íŒŒì¼ì˜ volume ë§ˆìš´íŠ¸ í•˜ëŠ” ë¶€ë¶„ â€œoim-geoserver-data:/geoserver-dataâ€ ì—ì„œ oim-geoserver-data(docker ë‚´ë¶€ì—ì„œ ìë™ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” volume)ì„\në¡œì»¬ í˜¸ìŠ¤íŠ¸ì˜ ê²½ë¡œë¡œ ë§ˆìš´íŠ¸í•˜ê³  docker-compose up -d â€”build ìœ¼ë¡œ ì‹¤í–‰í•˜ì—¬ ì‚¬ìš©í•˜ê±°ë‚˜ geoserver container ì— ë§ˆìš´íŠ¸ í•œ geoserver-data í´ë” ì•ˆìœ¼ë¡œ íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.\n(docker container cp â€œë¡œì»¬íŒŒì¼â€ oim-geoserver:/geoserver-data)</li>\n</ul>\n<h3>4. ì‚½ì§ˆí•œ ë‚´ìš©â€¦</h3>\n<ul>\n<li>\n<p>Dockerfile ì— RUN ëª…ë ¹ì€ ê°€ê¸‰ì  <strong>\\</strong>(ê°œí–‰) ê³¼ <strong>&#x26;&#x26;</strong> ì„ ì¨ì„œ í•˜ë‚˜ì˜ RUN ëª…ë ¹ì— ì´ì–´ì„œ ì“°ëŠ”ê²ƒì´ ì¢‹ë‹¤. RUN, COPY, CMD ë“± Dockerfile ì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ ëª…ë ¹ì–´ ë§ˆë‹¤ ë ˆì´ì–´(image) ê°€ ìƒì„±ë˜ë¯€ë¡œ, ë¶ˆí•„ìš”í•˜ê²Œ ë§ì€\në ˆì´ì–´ê°€ ìƒì„±ë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ í•˜ë‚˜ì˜ RUN ëª…ë ¹ì— ì‘ì„±í•˜ë„ë¡ í•œë‹¤.</p>\n<ul>\n<li>\n<p>RUN ëª…ë ¹ 2ê°œë¡œ Dockerfile ì„ ì‘ì„±í•˜ëŠ” ê²½ìš°</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> <span class=\"token operator\">\\</span>\n    apt-get update &amp;&amp; <span class=\"token operator\">\\</span>\n    apt-get install -y vim wget unzip &amp;&amp; <span class=\"token operator\">\\</span>\n    rm -rf /usr/local/tomcat/webapps/* &amp;&amp; <span class=\"token operator\">\\</span>\n    cd /tmp &amp;&amp; wget http://sourceforge.net/projects/geoserver/files/GeoServer/2.17.3/geoserver-2.17.3-war.zip &amp;&amp; <span class=\"token operator\">\\</span>\n    unzip /tmp/geoserver-2.17.3-war.zip -d /usr/local/tomcat/webapps &amp;&amp; <span class=\"token operator\">\\</span>\n    rm -rf /tmp/geoserver-2.17.3-war.zip</span>\n\n<span class=\"token comment\"># Enable CORS</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> sed -i <span class=\"token string\">'\\:&lt;/web-app>:i\\\n&lt;filter>\\n\\\n    &lt;filter-name>CorsFilter&lt;/filter-name>\\n\\\n    &lt;filter-class>org.apache.catalina.filters.CorsFilter&lt;/filter-class>\\n\\\n    &lt;init-param>\\n\\\n        &lt;param-name>cors.allowed.origins&lt;/param-name>\\n\\\n        &lt;param-value>*&lt;/param-value>\\n\\\n    &lt;/init-param>\\n\\\n    &lt;init-param>\\n\\\n        &lt;param-name>cors.allowed.methods&lt;/param-name>\\n\\\n        &lt;param-value>GET,POST,HEAD,OPTIONS,PUT&lt;/param-value>\\n\\\n    &lt;/init-param>\\n\\\n&lt;/filter>\\n\\\n&lt;filter-mapping>\\n\\\n    &lt;filter-name>CorsFilter&lt;/filter-name>\\n\\\n    &lt;url-pattern>/*&lt;/url-pattern>\\n\\\n&lt;/filter-mapping>'</span> /usr/local/tomcat/conf/web.xml</span></code></pre></div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f91746a8cfc5635cee81f8009a2c25e2/636c2/run-one.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeklEQVR42l2O2w6CMBBE+RNF5WJiGilIA1ZLKRFE/f/PObZ9Mj7sw86cndlkl5fsiyN6GBGyJs2KuP/O9pBTXRTz+uZuHaKqoyZbxTQ/Ub1Gej9kJeEgzUquxtJ2fQT/A0OJkA3usbC8PnT6xsZzp7P0j1iMm9BmiNwXZEY+l8CjMxsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"run-one\"\n        title=\"\"\n        src=\"/static/f91746a8cfc5635cee81f8009a2c25e2/5a190/run-one.png\"\n        srcset=\"/static/f91746a8cfc5635cee81f8009a2c25e2/772e8/run-one.png 200w,\n/static/f91746a8cfc5635cee81f8009a2c25e2/e17e5/run-one.png 400w,\n/static/f91746a8cfc5635cee81f8009a2c25e2/5a190/run-one.png 800w,\n/static/f91746a8cfc5635cee81f8009a2c25e2/636c2/run-one.png 911w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</li>\n<li>\n<p>í•˜ë‚˜ì˜ ì»¤ë§¨ë“œ ë§ˆë‹¤ RUN ëª…ë ¹ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apt-get update</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apt-get install -y vim wget unzip</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> rm -rf /usr/local/tomcat/webapps/*</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> cd /tmp &amp;&amp; wget http://sourceforge.net/projects/geoserver/files/GeoServer/2.17.3/geoserver-2.17.3-war.zip</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> unzip /tmp/geoserver-2.17.3-war.zip -d /usr/local/tomcat/webapps</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> rm -rf /tmp/geoserver-2.17.3-war.zip</span>\n\n<span class=\"token comment\"># Enable CORS</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> sed -i <span class=\"token string\">'\\:&lt;/web-app>:i\\\n&lt;filter>\\n\\\n    &lt;filter-name>CorsFilter&lt;/filter-name>\\n\\\n    &lt;filter-class>org.apache.catalina.filters.CorsFilter&lt;/filter-class>\\n\\\n    &lt;init-param>\\n\\\n        &lt;param-name>cors.allowed.origins&lt;/param-name>\\n\\\n        &lt;param-value>*&lt;/param-value>\\n\\\n    &lt;/init-param>\\n\\\n    &lt;init-param>\\n\\\n        &lt;param-name>cors.allowed.methods&lt;/param-name>\\n\\\n        &lt;param-value>GET,POST,HEAD,OPTIONS,PUT&lt;/param-value>\\n\\\n    &lt;/init-param>\\n\\\n&lt;/filter>\\n\\\n&lt;filter-mapping>\\n\\\n    &lt;filter-name>CorsFilter&lt;/filter-name>\\n\\\n    &lt;url-pattern>/*&lt;/url-pattern>\\n\\\n&lt;/filter-mapping>'</span> /usr/local/tomcat/conf/web.xml</span></code></pre></div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9688b460c97c08ecdba687b584b309ee/2a50c/run-multi.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 17.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwElEQVR42nWP1xKCMBBF+RNRIJQIFkZEQAZCCVjG9v/fck1Wxxf1YSft7tkTIwgXMG2GcBUj2WWYMY/Kcv1P6fdtXkB0EnGS0h3jIUQvkWQ5eLSkzCbNYEwshqnjElB0PWwv+ALqTFqUOF9v6McjXAVjwRxV26GRA0rRKIYamhUwTAXTwCjeoBvGP0CHgJf7g4aygMNXVvJwwr4SaOVI5juVMaZvIF+sUVT1T+Dry3uyK2tBdo7P1b6hHm2mz4lan5S6feZTQkuyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"run-multi\"\n        title=\"\"\n        src=\"/static/9688b460c97c08ecdba687b584b309ee/5a190/run-multi.png\"\n        srcset=\"/static/9688b460c97c08ecdba687b584b309ee/772e8/run-multi.png 200w,\n/static/9688b460c97c08ecdba687b584b309ee/e17e5/run-multi.png 400w,\n/static/9688b460c97c08ecdba687b584b309ee/5a190/run-multi.png 800w,\n/static/9688b460c97c08ecdba687b584b309ee/2a50c/run-multi.png 925w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</li>\n</ul>\n</li>\n<li>\n<p>Dockerfile ë¡œë¶€í„° ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ ë•Œ docker build ëª…ë ¹ì€ Dockerfile ì„ í¬í•¨í•˜ëŠ” ë””ë ‰í† ë¦¬(ì„œë¸Œë””ë ‰í† ë¦¬ë¥¼ í¬í•¨í•œë‹¤)ë¥¼ ëª¨ë‘ Docker ë°ëª¬ìœ¼ë¡œ ì „ì†¡í•œë‹¤.\nê·¸ë˜ì„œ Dockerfile ì˜ ì €ì¥ ìœ„ì¹˜ëŠ” ë¹ˆ ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“¤ê³  ê±°ê¸°ì— Dockerfile ì„ ë†“ì•„ë‘ê³  ì´ë¯¸ì§€ë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•ì„ ê¶Œì¥í•œë‹¤.</p>\n<ul>\n<li>Dockerfile ê²½ë¡œì— íŒŒì¼ì´ ì—†ëŠ” ê²½ìš°\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b4093bcd12b801cf2f98c2a6af86f05c/4d383/dockerfile-build1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 38.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhklEQVR42l2R23KiQBRF+Y6ZqUQFFLwgCgpya+5gNKTm8jL//yFrujtmKpWHVQ1UsXrvcwxxvxCWe465zz7OiaKCNhYkSYkvOcjnQ5bhhSk7P8A7hkRphh+cWLobVpstztZjZi253icMUQ4EYUJVj6SiZJI054g/XUcsCs5xyunNwg1trPVK//hkWjybNnN7pVksHb49zWiHK0YzlcTNmeZek3Ujt+7Gr7LndXglqwcq0VPdMuL7ibgLCfNQpgxwd3s2+4PEl8mPuDLl9PM3RtEViL6kGlvyquVS1OSiIa17RlHz93hm8gJM19PVnO1O1txhy7qOPNW7+m7KlC/TG0acFlog6pZDeNK3qZt3/oF9EOpvak6qqq5nO7qiYv7AXLl8f57TjS8YSV5QVI1MV+v4a++BrKTOjUTVW8o0agmLh+AzlrPmx8ykv94wMlHRDKNGbU5tUaFEekYPoaplu+v/ws/id+HiXSjqhqysqNqeKEm5yMRRkmmZGvTHJhV6Vl9kX4X/ABju/tbC0L/4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"build1\"\n        title=\"\"\n        src=\"/static/b4093bcd12b801cf2f98c2a6af86f05c/5a190/dockerfile-build1.png\"\n        srcset=\"/static/b4093bcd12b801cf2f98c2a6af86f05c/772e8/dockerfile-build1.png 200w,\n/static/b4093bcd12b801cf2f98c2a6af86f05c/e17e5/dockerfile-build1.png 400w,\n/static/b4093bcd12b801cf2f98c2a6af86f05c/5a190/dockerfile-build1.png 800w,\n/static/b4093bcd12b801cf2f98c2a6af86f05c/4d383/dockerfile-build1.png 1195w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>Dockerfile ê²½ë¡œì— íŒŒì¼ì´ ìˆëŠ” ê²½ìš°\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d143b0522a87dd2afd5cd4c151fd4ddf/061c7/dockerfile-build2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 37.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYElEQVR42oWS2XKCQBBF+Y+kUsaoICCrxIVtgAFRSSyroGLikv//iptmEnxKzMOpXmbp2z0jMZ4jZCnKzRbZeost+fnExKncIC1KJJwjbmwYngXNtDDWTaiG9SdSyBLMlgGyYoWILs8jhsIPUecrLGlt7kd43hhY7MdwUh2qp+FJVtAbjH5FShoPfmUhqgLMsxcU+Q4136HMKvhpBcZfERRreJzReopZnMKdzTGmLnTLwcR2hDLTmYpYCnkItkrAiowUcbz5DAc/xjnJ8U7qancGZrjoKwYU1YCsTQTDsQZFNwQjVf/2KS8t6HDEMjFH03FFFcOimZG1px4sd0qHVdHO41BGf6RcaeMuJ3yyUpSkiDOOgOal/rShmfaVNm7b65QMFPUm0iIIESUZfHoMWdPFpa3tNgyJTtFDf4C7Xh/3N5CO5wsOxxOOl0/s6wbN4UPYnL5NSxAnYhwCKhz9wxdNqQNDR8ch/QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"build2\"\n        title=\"\"\n        src=\"/static/d143b0522a87dd2afd5cd4c151fd4ddf/5a190/dockerfile-build2.png\"\n        srcset=\"/static/d143b0522a87dd2afd5cd4c151fd4ddf/772e8/dockerfile-build2.png 200w,\n/static/d143b0522a87dd2afd5cd4c151fd4ddf/e17e5/dockerfile-build2.png 400w,\n/static/d143b0522a87dd2afd5cd4c151fd4ddf/5a190/dockerfile-build2.png 800w,\n/static/d143b0522a87dd2afd5cd4c151fd4ddf/c1b63/dockerfile-build2.png 1200w,\n/static/d143b0522a87dd2afd5cd4c151fd4ddf/061c7/dockerfile-build2.png 1216w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n</li>\n<li>postgis image ëŠ” íƒ€ì„ì¡´ì´ í•œêµ­ì‹œê°„ì´ ì•„ë‹ˆë¯€ë¡œ ë°˜ë“œì‹œ Dockerfile ì‘ì„±ì‹œ í™˜ê²½ë³€ìˆ˜ë¡œ <strong>ENV TZ=Asia/Seoul</strong> ê³¼ ê°™ì´ ì¤˜ì•¼ì§€ ì œëŒ€ë¡œ ëœ ì‹œê°„ì„ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.</li>\n<li>postgis image ì—ì„œ psql ì€ <strong>docker-entrypoint-initdb.d</strong> í´ë”ì— ì‘ì„±í•œ ìŠ¤í¬ë¦½íŠ¸ë§Œ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë‹¤.</li>\n<li>\n<p>ì»¨í…Œì´ë„ˆê°„ ë„¤íŠ¸ì›Œí¬ë¥¼ ê³µìœ í•˜ëŠ” ê²½ìš°ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•´ì¤˜ì•¼ í•œë‹¤.(ì˜ˆë¥¼ ë“¤ì–´ geoserver container ì—ì„œ db container ì˜ ë„¤íŠ¸ì›Œí¬ë¥¼ ê³µìœ í•´ì„œ postgis ì €ì¥ì†Œë¥¼ ë“±ë¡í•˜ëŠ” ê²½ìš°)</p>\n<ul>\n<li>\n<p>service:â€œdocker-compose íŒŒì¼ì— ê¸°ìˆ í•œ ì„œë¹„ìŠ¤ëª…â€</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\">services:\n      db:\n        build:\n          context: ./doc/docker/postgres\n          dockerfile: Dockerfile\n        ports:\n          - 15432:5432\n          - 18080:8080\n\n      geoserver:\n        image: gaia3d/geoserver:oim-2.17.3\n        network_mode: \"service:db\"</code></pre></div>\n</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/docker-compose-use/","prefix":"2020-10-13"},"frontmatter":{"title":"docker ë¡œ ê°œë°œí™˜ê²½ êµ¬ì„±í•˜ê¸°","category":"docker"}},"authornote":{"id":"265dda60-7971-5464-926f-ea569c79ac0a","html":"<p>ğŸ”˜ ì•ˆë˜ë©´ ë  ë•Œ ê¹Œì§€! ğŸƒ ğŸ”˜</p>"}},"pageContext":{"slug":"/docker-compose-use/","prev":{"id":"3439b04c-5731-56cf-b9ba-9a82df058350","fields":{"slug":"/docker-compose-manual/","prefix":"2020-08-27","source":"posts"},"frontmatter":{"title":"Docker Compose ì‘ì„± ë°©ë²• ë° ëª…ë ¹ì–´ ì •ë¦¬","category":"docker"}},"next":{"id":"e43209b6-1808-5f96-858e-7058da4c0fc6","fields":{"slug":"/web-application-server/","prefix":"2020-12-13","source":"posts"},"frontmatter":{"title":"Web Application Server ì™€ servlet","category":"java"}},"source":"posts"}},"staticQueryHashes":["960164547","960164547"]}