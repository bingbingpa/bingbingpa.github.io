{"componentChunkName":"component---src-templates-post-template-js","path":"/jenkins-build-deploy/","result":{"data":{"post":{"id":"da04348e-8f44-50ff-a4fe-6cbf6a5ac7f2","html":"<h2>목표</h2>\n<ul>\n<li>git repository 의 특정 브랜치에 소스가 push 되면, git repository 의 webhook 설정에 의해 jenkins 의 아이템을 실행한다.</li>\n<li>item 은 pipeLine 으로 구성하고, Jenkinsfile 을 작성하여 빌드 및 배포 구성을 코드로 관리한다.</li>\n<li>\n<p>빌드 구성</p>\n<ul>\n<li>gradlew clean build</li>\n<li>build 결과물을 바탕으로 Dockerfile build</li>\n<li>docker compose 로  n 개의 springBoot app, maria-db container 를 실행</li>\n<li>slack 으로 배포 결과 알림</li>\n</ul>\n</li>\n<li>포스팅에 사용한 저장소: <a href=\"https://github.com/bingbingpa/spring-boot-with-docker\">https://github.com/bingbingpa/spring-boot-with-docker</a></li>\n</ul>\n<h3>1. 젠킨스 설치</h3>\n<ul>\n<li>\n<p>저장소 키 다운로드</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">wget</span> -q -O - https://pkg.jenkins.io/debian/jenkins.io.key <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> apt-key <span class=\"token function\">add</span> -</code></pre></div>\n</li>\n<li>\n<p>sources.list 에 추가</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">echo</span> deb http://pkg.jenkins.io/debian-stable binary/ <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/apt/sources.list.d/jenkins.list</code></pre></div>\n</li>\n<li>\n<p>젠킨스 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">install</span> jenkins</code></pre></div>\n</li>\n<li>\n<p>초기 설치시 기본 포트는 8080 이며, 필요하다면 변경해주도록 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/default/jenkins</code></pre></div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/71f71ae8f0de61490d62aa4d132d9294/9144d/jenkins-port.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 401px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 23%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVR42pWPXW7CMBCEfZNSe9dxAkhAVZFATMiPA6RSe//TTNcJCITEAw+fvDsaeWfU4bjCZ+Fh2wDuz+BjA+4CaL2BJguTpG+hvF/iw2YwqZAtoOdLmefQ0eBEsw7a8IQcGIkaJ3fifkWV1QqmOMDVDSjPYYsSvPegbQFbt6Dv7ZS67eStwb6CWX+Bw0m0MGrRy6cL7DBAVfUGedWiDD128kE//GDXdLj8/sGLWceUMfXIYmxhblr2sF9nVUrlGTmwS+HERFKVkgxWapMYX9Z7qjppDv+Hs5iTQoDD5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"jenkins-port\"\n        title=\"\"\n        src=\"/static/71f71ae8f0de61490d62aa4d132d9294/9144d/jenkins-port.png\"\n        srcset=\"/static/71f71ae8f0de61490d62aa4d132d9294/772e8/jenkins-port.png 200w,\n/static/71f71ae8f0de61490d62aa4d132d9294/e17e5/jenkins-port.png 400w,\n/static/71f71ae8f0de61490d62aa4d132d9294/9144d/jenkins-port.png 401w\"\n        sizes=\"(max-width: 401px) 100vw, 401px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</li>\n<li>젠킨스의 pipeline 으로 docker 를 실행하기 위해 권한을 부여한다.</li>\n<li>\n<p>/usr/bin/docker 의 사용자그룹을 jenkins 에 추가해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">usermod</span> -aG root jenkins</code></pre></div>\n</li>\n<li>\n<p>서비스를 재시작하고 잘 기동 되었는지 확인한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> systemctl restart jenkins\n<span class=\"token function\">sudo</span> systemctl status jenkins</code></pre></div>\n</li>\n<li>localhost:8091 로 접속 후 /var/lib/jenkins/ 경로의 secrets 폴더에서 initialAdminPassword 의 내용을 확인해서 입력한다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4f778b925c8c96d14cfa5e7257c74106/0a867/jenkins-init-password.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 40.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVR42n1Sy3LDIAz0//9XOk19S2+++OoxTxuDAT82gpo06dTRzA4Sj5VWouKMoes6KKWw73vGtm0v/rquD6T4HSofQnastTDGYJosnHMYxzHH8zxjWZZTPCdLqLz3CERa1zWu1098325omgYflwu+KG7bNidc4i/Bf8RFVRVjzJeUVhBSgkkNpoaMnnxOe5LO8rkQ0FofSqYXJMJkVSJLzPNAEgU9YgM4NxlK0EOhYWnf6RGe5Cc1Z5YrLIRWD3BUlZMKExdEJPNqek6glcvc29RT+1TRKSHjHD1NnJMsT20I1Jd4IGRElH6HY5DlFxT/ITlZmvJkfvpRkrzD3+9SCO9+5W3fWzgiGAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"init-password\"\n        title=\"\"\n        src=\"/static/4f778b925c8c96d14cfa5e7257c74106/5a190/jenkins-init-password.png\"\n        srcset=\"/static/4f778b925c8c96d14cfa5e7257c74106/772e8/jenkins-init-password.png 200w,\n/static/4f778b925c8c96d14cfa5e7257c74106/e17e5/jenkins-init-password.png 400w,\n/static/4f778b925c8c96d14cfa5e7257c74106/5a190/jenkins-init-password.png 800w,\n/static/4f778b925c8c96d14cfa5e7257c74106/0a867/jenkins-init-password.png 986w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>install suggested plugins 를 선택해서 추천 설정으로 설치한다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e472196db878f36ccf641bb198c5273f/508ef/install-suggested.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 578px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVR42n1S7W6jMBDk/Z+szZ9TdWnvToQQIBCwIUDBhO/p7qauUFrdSsOyNoxnvOuUZQmlFKqqwrquWJblR/De/8AxzzMcYwwY4zjKot3cfsgxTZN8w/kRTGTh8OlMGAQBjscjfN+XHEURwjCE67qyNgzDl4NHdds1hx9d1wmJ/dnzPDngdDrBOxykbttWSIe+R/8JrlnV1pHzeA82lmXFxDbodKlp/255Rk9Ed9Lhm2KHnphocR/n2HkxXim/hApx3SEzI3LT43K54HDwEJ3PiJMELV3RMIzobje5Q9K3IaRimBf8ijSe/RRu3sAvDc5Nj+C9R0LEKsvEfl3XaJoGNyIypgVPCE8H98AqddjObZyxzyrs01Lwmlb4fSnxpt8Rlg2uRSGjxciInBWnaQqd50RYf5FyCKEZJjxHOZ7CXPLuXGDHdVTA1RUpTKXrCdmN41jAxEppUWwhY3NXOOGPqvCXFP0j2PymagQFKSBrxfWKq6CE1jkSUqm0lu4zGXecbTv37toOrz/g820zCfzj42Db+ABlqk6E39Q/IwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"install\"\n        title=\"\"\n        src=\"/static/e472196db878f36ccf641bb198c5273f/508ef/install-suggested.png\"\n        srcset=\"/static/e472196db878f36ccf641bb198c5273f/772e8/install-suggested.png 200w,\n/static/e472196db878f36ccf641bb198c5273f/e17e5/install-suggested.png 400w,\n/static/e472196db878f36ccf641bb198c5273f/508ef/install-suggested.png 578w\"\n        sizes=\"(max-width: 578px) 100vw, 578px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2cf32cdd6c424d4e1c9a6dd5665d4bf5/e4900/jenkins-install.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 85.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACIElEQVR42q2UW6+TQBDH+f4fxPPiiw9GEx9MjJp4OefB3sw55bawFNhdWgqld/7ObKm2WmuaSPLvwuzMb2eGKY4xBnmeoygK7Ha7P7Tf72+Ss1wusd1u0bbAnn7YuONNNtDV0rper7HZbM7EMZfkrFYrG5DEAqkUKFQGlSYkiUTGSNPMQq9l23aJ2Ay3dNpqvcGLt19w9+o9nr18h+dvPuHu9Ud8+PwAEQbW8VpWfFjbVeTs2EgBT1mNUcKqMJRzDGSFxebgdAy6JgaynHZ/CPpfl9ML+3hMHuEq32oYj9AXQ4gyhmd8fAt6GMXfac+Dq12MszGe0idEtJ+rw3RUVYW6ZtVwvgb3uPcf0Jv0MTYu4kwiTELk0xwTkyKQAWQuyR4j0am1l02JGUlEAkIIKKUwn88t2HFDH1ESIVXkrBWmxQxaacyKKYwp4I5d+B75iIiymaLQxu43dQOjNZIksaAlTQtPjCNEbB1YPOSGSuBBr6gEQ4DBYADP8zCZTKC7P0GWZSjLEpoSyLLcgo5ygjC0p7ATO+eUPgdzgKJDXIKlaWoD2Y8lu5X9At+3+4vF4lByRD2QknoUx1Z8f/rMgcf7Ux3tvNYEa5rGQh3RAX8HHeGnh5z6MEh3PeRqVr96KP4aeAl0BqT28DO/LIbxd+EMeIsYqKjnHMu9+wmMouifmV2SBaoDkGeQPzAWGAQBGHqLuKqIsjRGd7009qUw8AfigAKyoRlL6AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"install\"\n        title=\"\"\n        src=\"/static/2cf32cdd6c424d4e1c9a6dd5665d4bf5/5a190/jenkins-install.png\"\n        srcset=\"/static/2cf32cdd6c424d4e1c9a6dd5665d4bf5/772e8/jenkins-install.png 200w,\n/static/2cf32cdd6c424d4e1c9a6dd5665d4bf5/e17e5/jenkins-install.png 400w,\n/static/2cf32cdd6c424d4e1c9a6dd5665d4bf5/5a190/jenkins-install.png 800w,\n/static/2cf32cdd6c424d4e1c9a6dd5665d4bf5/e4900/jenkins-install.png 988w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>설치가 끝나면 적절한 계정을 생성하고, url 에 별도의 컨텍스트가 필요하다면 추가한다.</li>\n</ul>\n<br>\n<h3>2. 젠킨스 아이템 설정</h3>\n<ul>\n<li>\n<p>repository 에 Jenkinsfile 추가하기</p>\n<ul>\n<li>젠킨스 pipeline 에서 사용할 Jenkinsfile 을 프로젝트의 루트 경로에 다음과 같이 작성하고 커밋 &#x26; 푸쉬</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">  pipeline <span class=\"token punctuation\">{</span>\n      agent any\n      stages <span class=\"token punctuation\">{</span>\n          stage<span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              steps <span class=\"token punctuation\">{</span>\n                  script <span class=\"token punctuation\">{</span>\n                      <span class=\"token function\">sh</span> <span class=\"token string\">'echo test'</span>\n                  <span class=\"token punctuation\">}</span>\n              <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>github token 생성하기</p>\n<ul>\n<li>jenkins 에서 github repository 인증을 위해 사용할 token 을 생성한다.</li>\n<li>settings - Developer settings - Personal access tokens - Generate new token 선택해서 토큰 생성</li>\n<li>repo, admin:repo_hook 만 체크하고 생성한다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f737f40944ed9980ffa372241a07f456/d54e4/github-token.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 747px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1ElEQVR42o1Ui3KEIAz0/z+y7cy9PBUE3w8kzeaA0961U2YyKMiyu0nMTmqhShlyzpH3PsUwjGSb9hDjNMvetm0c/hhhPZsWR0ppKsuK+n6QAxhd35OuDSldk7UNLcua9n4b2M+2zZHWmvL8TjUD4BYMgGsGU9rIhdM8p0PvIgE6BlBKUX4vaJqmdFvbdcIuBljKuR3AnlkCXNZVmCDathU/sAHJhkEQDftnjKV1dUcP/TPiejaOI92LggaeMR6AROM4Mcue+mEQ+WC89xHTT9k4m8GbPM/p4/OLs63Txw2zLSolazrIxnPByTPWvlRFApwZsKwqulyvcsAHL8AOWUaibJBes2y8G9MQvH+RD8mQdL3dhAVkpjpkC5q2E+COI86oR1gAZS5URGQngMuyCENI2mcMh4VRiMjQhHcQwDcAd27blQ17YYxhUJWqPnookgMALhQgXkNM3DUzk8EMwJRlSLtzDSLTigs8Mhy5JluW/JDbHbroXYfEyHzolPP5QkVRJl8gEUkCczz/1SUHwLJlwNqmbMbCBkMU9yMGeX9m9ljUKSC57le6XG50Op+ln6MseFilOjQC+K+fg/cb+9Qxy1paDLfLz4HLyTaPtoN//5X8DQGk38ewAnFhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"github-token\"\n        title=\"\"\n        src=\"/static/f737f40944ed9980ffa372241a07f456/d54e4/github-token.png\"\n        srcset=\"/static/f737f40944ed9980ffa372241a07f456/772e8/github-token.png 200w,\n/static/f737f40944ed9980ffa372241a07f456/e17e5/github-token.png 400w,\n/static/f737f40944ed9980ffa372241a07f456/d54e4/github-token.png 747w\"\n        sizes=\"(max-width: 747px) 100vw, 747px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n</li>\n<li>\n<p>젠킨스 아이템 설정</p>\n<ul>\n<li>메인 화면 좌측 메뉴에서 새로운 Item 선택</li>\n<li>item 이름을 입력하고 Pipeline 을 선택 후에  OK\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/64dab3fd82ab5e705f57767f9e9d91c3/561da/jenkins-item-choose.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 83.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACSUlEQVR42n2UyW4TQRCG+115Ch4GcUfiGSJx4AASgjjBGcwQz770MvtiB/FT1bNkLBwOn6q3qvq7ehFxJnGMUhzDxOLFGWTZXKGGLF5gnjNVA3FwH/Hl6y123/e42z/gfu8gydUFMZHqEjk5ZaZCxnbDMq4osYjSHM7PX0ilRtX1NkuuiwlTQJrSthNVWKeUA86kmz4nVKRU6KJCIhWk0sg5aNOiG0Z0/Yi2H9BQEqb9D9s1Ig8f4O4/48fBxd1uB9/3Eccx4ihClmUwRkNJiSxNkRJKSUg5kec52RxGa9uua1LYdB2UMXagaRo7WFWVZRgGPD094Xw+r5xOp5VxZu2PI4SignIdfc+D1gZlWZIqQ0qUVceJsiy3lse2CVnAQk1wQtFRnUxRIkkSu90gCOyW2eHZebLstFW4ZVFPh1IgpHodj0cLB+TArJLVsiq2murEbVbKba5vQb7LVheE46X45vhU+Aw91axt6ZSprqxuqeliF7Zb3cI1F6mu6aVIBL5nlYVhiIgUh2Fg22Ew2akcod3Bcz+Ya22sahYjeDthFNsFyyKeYJbM2z7bvu+tGoa3eXHKml5DlKTT3ZsxNMZZl8x8+lwvbvP945Kw8zCMa+AluIiTDM7hkS72Aa7r2utTzMGYtU3BmvlqTAcwXBzGeigtZcPvEX/OA4q6gaKnKO0b3lJay3O85hr8B/CzFbd+hFdvb/D6/Ud49Iz455gefP0P9jPQ10noc+AvTAT0Kbz5cI93nxzIqkTZdJSxvQ7PvQTNV22PvxtgBRrarrBTAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"jenkins-item-choose\"\n        title=\"\"\n        src=\"/static/64dab3fd82ab5e705f57767f9e9d91c3/5a190/jenkins-item-choose.png\"\n        srcset=\"/static/64dab3fd82ab5e705f57767f9e9d91c3/772e8/jenkins-item-choose.png 200w,\n/static/64dab3fd82ab5e705f57767f9e9d91c3/e17e5/jenkins-item-choose.png 400w,\n/static/64dab3fd82ab5e705f57767f9e9d91c3/5a190/jenkins-item-choose.png 800w,\n/static/64dab3fd82ab5e705f57767f9e9d91c3/561da/jenkins-item-choose.png 969w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>Build Triggers - GitHub hook trigger for GITScm polling 선택</li>\n<li>파이프 라인을 아래와 같이 설정한다.</li>\n<li>Repository URL 은 위에서 사용한 저장소 url 을 입력한다.</li>\n<li>branch 는 실제 github 저장소에 push 되었을 때 배포가 이루어질 branch 를 선택한다.</li>\n<li>Script Path 는 github 저장소의 Jenkinsfile 의 경로를 적어준다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/da59b405259aa6e632dca007a3969272/b2cef/pipeline-setting.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 88.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAUlEQVR42pWUe0/bMBTF8/2/1SZNCKYVtEmbCpSJpE3zch52HnbS6uzchKIgWsj++Cm16xyfe3NsL0wUhG2Uwg9j7Pn7eReNyDhOFaIoRlZqpMXHKK7xtNYoqwqNtXDDACv0PRlGxjnn4D6h5ztV3cBr2hb7IMDucYM2z+Eo/oayhOMaEbXc9ByOtF0HPy3htU0DdXWN4MtXRNc3yFd3UKtbPifUjxXqn7/QixO6uOSu7SxyXdMhBYvNBvF6DRNsUT37qHwfmq7NdgvtB2h34SR4qVwigkoEW5ZT1QaJUlCVRmEM3OGA/kgOEzK+VK4ggp11KA17WNc1LOsX2x3FZQMZv+vTGWen+ZpVZiqHaI0ln3vhI0fzTTpunmYKPttlTD05NCzT8CniS8XmiKg7HlE1rcSmQZokiHY7KMZGRAVZtIgX0fz2DkGY8KMUBRLGJfh2hZSTCcULzklPl3Jg+Os4QZpXdCiuHh7RMS6OERn4p3DK1yXmGWxYaslTIuEeT8opJvI8lfI/PdSasUtSJkSOHj+G9DCJ47HUeRyWYO0UbKkqyvUUmziOkGUZtJzdMaj9uOiVhb0041emQEh3Qbjn9VOik50P0y3zykK3A0W9inEJ7x9geOcNRQlLp90MyxOwtJf7sWRGJb75jmZ9j/7pL9zm6S2//2B46dFnyBX3D2Deax8da4nwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"pipeline-setting\"\n        title=\"\"\n        src=\"/static/da59b405259aa6e632dca007a3969272/5a190/pipeline-setting.png\"\n        srcset=\"/static/da59b405259aa6e632dca007a3969272/772e8/pipeline-setting.png 200w,\n/static/da59b405259aa6e632dca007a3969272/e17e5/pipeline-setting.png 400w,\n/static/da59b405259aa6e632dca007a3969272/5a190/pipeline-setting.png 800w,\n/static/da59b405259aa6e632dca007a3969272/b2cef/pipeline-setting.png 847w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>\n<p>Credentials Add 를 눌러 새로운 Credentials 를 등록하고 선택한다.</p>\n<ul>\n<li>Username 은 자유롭게 입력</li>\n<li>Password 에 위에서 생성한 github token 을 입력한다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c2c06eb797fa06c7566a248eb9813bf2/a0730/github-jenkins.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVR42p2TW3OCMBCF8/9/WbGgUMEXageK5kJAuYtPp9k48NAyTvHhmzDL5szZS1h0CLHb+dhudwiCD7w5Dt5dF67nwTMxPwjgbDbIshOUyiGkglxCKQghwcJDhP1+D9/3EUYROOfgQpifwn5PJ4nluTbky2htc9j5fJ6D2gTHccTtdvvDMAxPoZy6rsGKosD1erW0bTsn9H2/CrrTkOCjHIWyLK0g0XXdosvnjOC6BJtKJYckSo4n8TUOO4PUFzAppe3f2p4toS8VWMpLO0kSJXdT2WvoDI0hERrsePxCHMdI0xRJkmByTH39L7l67OFnmoFRv5qmQVVVL1Pbs8ZJ5g9B2p9h6Fevyu+hqMIMZdo/Gjst9cvc7yirxrwULnAyr+U7y+an9grUe2Hu/wDD9NjlJrnwqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"github-jenkins\"\n        title=\"\"\n        src=\"/static/c2c06eb797fa06c7566a248eb9813bf2/5a190/github-jenkins.png\"\n        srcset=\"/static/c2c06eb797fa06c7566a248eb9813bf2/772e8/github-jenkins.png 200w,\n/static/c2c06eb797fa06c7566a248eb9813bf2/e17e5/github-jenkins.png 400w,\n/static/c2c06eb797fa06c7566a248eb9813bf2/5a190/github-jenkins.png 800w,\n/static/c2c06eb797fa06c7566a248eb9813bf2/a0730/github-jenkins.png 1131w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n</li>\n<li>Credentials 정보를 선택해주고 저장한다.</li>\n<li>등록한 아이템을 실행해 본다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f0f9b5c234dd34ccc135180399bdc2d9/86a1e/jenkins-first-build.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 17.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42o2Jy06DQABF+XaLtFRSaNH6SvyN/oYL3VRbH7Ugj8JCHQaccpwZExfGhTc5uS/nUymEEJqGpvnG5L/6D792KSVlVbFKdzh+dMpgHOGHc4aTOQd+yOHRFC+YEZ1c6jzD1f8wiInPrmw3hMcXTOJz/U1xRyGeFzBwxzh3m5zVNuMpLbh9TLXnJHnJNit4eEntbrohLSrNzn7PScaryWVNsrxnvViwub7B4R/qNR+totv31KKlVXs61VO+SbuJTlG/S+tfMGka2cZVeoIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"first-build\"\n        title=\"\"\n        src=\"/static/f0f9b5c234dd34ccc135180399bdc2d9/5a190/jenkins-first-build.png\"\n        srcset=\"/static/f0f9b5c234dd34ccc135180399bdc2d9/772e8/jenkins-first-build.png 200w,\n/static/f0f9b5c234dd34ccc135180399bdc2d9/e17e5/jenkins-first-build.png 400w,\n/static/f0f9b5c234dd34ccc135180399bdc2d9/5a190/jenkins-first-build.png 800w,\n/static/f0f9b5c234dd34ccc135180399bdc2d9/c1b63/jenkins-first-build.png 1200w,\n/static/f0f9b5c234dd34ccc135180399bdc2d9/86a1e/jenkins-first-build.png 1296w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>메인 좌측메뉴의 빌드기록에서 콘솔 버튼 선택\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0f59c17ef44b94cd72e0d88a8963abcd/8802b/build-record.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 42%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVR42nWQzU7CQBSF5/3fwChQCAWKkqiJCx+AsMEUKZUC7ZCWn+n0Z21hc7wzUlJBFl/OOT33TpPLdhuOKArBOddst1vKG3wXBQ6HA1HgeDxqivO3a8qO7fYCaZoiyzJIKZEkifZxHGMv9lqlTCFEfPISglQIob3O5FWn3mG+7+MWQeBjtfLhzhdYLJaUgxtzAc2tEIYhmArl4H9ewTlxo6vuRFEENvfU30uWFX/B8rL7mz3Pw3q9BotjiTzP6HaSbqDul2pV5Fn6mxOp+7LLNJU52ld3V8qsp2c8GCaMdg8da4BGq4t6q3Oie9b+4AUts49akzJh9gZomhZqtNtotHF3b+D17R1s9OHAnrqYfXkYjqcax51fYX/OKtmDPXEwIe+ObQzrBka9R/Bwgx+wzjdbg0WXJwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"build-record\"\n        title=\"\"\n        src=\"/static/0f59c17ef44b94cd72e0d88a8963abcd/5a190/build-record.png\"\n        srcset=\"/static/0f59c17ef44b94cd72e0d88a8963abcd/772e8/build-record.png 200w,\n/static/0f59c17ef44b94cd72e0d88a8963abcd/e17e5/build-record.png 400w,\n/static/0f59c17ef44b94cd72e0d88a8963abcd/5a190/build-record.png 800w,\n/static/0f59c17ef44b94cd72e0d88a8963abcd/8802b/build-record.png 1135w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>Jenkins 파일이 정상적으로 동작하는지 확인해 본다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8a80fa4dbfe7acc935c4705cce9add02/d72ec/build-console.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 393px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 116.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVR42qVVCZKCMBDk/19UURBF5JD7ht7pKC67igqmaipHJZ3uORLN81ysVmv40lvWAaZpIs8LHA4WojiG57ow9yZs+wg/CGDt9wijCGx93ysbN82VA6fTSZlpGlivN+CaY9vY6FtstzqOx6NcuoKub2DLvikwBZhlGXzfRxiGiIVRXddo21ZZJeOqqq5j6WlN09wBn7U7YCQykiRRB6IoVPOpNoC9ZHgFjJEKqOt5yo9jaWP7SDIBYwGj5PHGKWlT7Q9gmqaIpWcUn7H6HFAkMij0YVmWCOSCVNZfSXvD0LtHOZc5+7btlksOJGEJQsn3tED/MpqTgHme43x2lB9pvGCp/xQg/WYYBi6XCxzHQdd1D76bxZABOUup9X2nwP4fns2QkimVDKNb6dW3khuzXZSHyS2xi6KQSslUDX8NyCgPLN/V7SSg5/3mIQG5xhT6uvQGyayWQnxbj56qWQyf+ZDjaoHsh1pu2gaM/BCQuemj0oalx7cwEb9RKtkyhXgZbU60tcAP5EM6yAdlySfkY7fbqnkusimd/pyTj1pZlCqilEwA9dCq12aZ5B9fJgyH2k28EwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"build-console\"\n        title=\"\"\n        src=\"/static/8a80fa4dbfe7acc935c4705cce9add02/d72ec/build-console.png\"\n        srcset=\"/static/8a80fa4dbfe7acc935c4705cce9add02/772e8/build-console.png 200w,\n/static/8a80fa4dbfe7acc935c4705cce9add02/d72ec/build-console.png 393w\"\n        sizes=\"(max-width: 393px) 100vw, 393px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n</li>\n</ul>\n<br>\n<h3>3. github webhook 설정</h3>\n<ul>\n<li>repository 에 푸쉬가 발생했을 경우 젠킨스에 알려주기 위한 webhook 을 설정한다.</li>\n<li>\n<p>젠킨스에서 등록한 아이템의 github 저장소에서 Settings - Webhooks - Add webhook 선택</p>\n<ul>\n<li>Payload URL 에 젠킨스 서버의 url 을 적어줘야 하는데, localhost 가 아닌 외부에서 접근할 수 있는 도메인이 필요하다.</li>\n<li>여기서는 테스트를 위해 ngrok(<a href=\"https://blog.outsider.ne.kr/1159\">ngrok으로 로컬 네트워크의 터널 열기 참조</a>) 으로 외부 도메인을 바인딩한다.</li>\n<li>공식사이트에서 실행 파일을 다운받고 콘솔에서 다음과 같이 사용할 포트를 입력해준다.</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./ngrok http <span class=\"token number\">8091</span></code></pre></div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cbfe77d2cf42c2ef571e400fd70f4d5e/38af3/ngrok.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 23.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsElEQVR42pVQyQrCMBCd1KbZNy0I1gT6/x/5zKQeLHjQwzBheGtIOo1LjqAQQCmDlgVEBBJ07H8nJA2pCOLj6JPF/XGDMQZaa8zz/Ltgaw0ppXcqMfa6rtj3HbU+UVvF9tw6JiLnDB88lFIIvVGMEaUUlGsZ5kMjl9wBy8nFWDMIPN77IcKmjGUyp2bxITqMEqyzB19pBSnPlZb+j9M0jSSip/begXF8d/3Ngpz4W+UXKsJr/dKz+uMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"ngrok\"\n        title=\"\"\n        src=\"/static/cbfe77d2cf42c2ef571e400fd70f4d5e/5a190/ngrok.png\"\n        srcset=\"/static/cbfe77d2cf42c2ef571e400fd70f4d5e/772e8/ngrok.png 200w,\n/static/cbfe77d2cf42c2ef571e400fd70f4d5e/e17e5/ngrok.png 400w,\n/static/cbfe77d2cf42c2ef571e400fd70f4d5e/5a190/ngrok.png 800w,\n/static/cbfe77d2cf42c2ef571e400fd70f4d5e/38af3/ngrok.png 894w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</li>\n<li>커맨드 실행 후 Forwarding 도메인을 등록한다.</li>\n<li><strong>도메인 뒤에 꼭 /github-webhook/ 붙어야 한다. 마지막에 / 도 꼭 필요하다.</strong>\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b7d2a4706547240a810a7cc5f03b27b5/7de01/webhook.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 794px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 86%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/UlEQVR42o1UTY/TMBDN/78i8QsQZw4ckeCOhIS4gVZamraOnebLjuM4TvKYcbatly1dLD2NPXHGb96MndXG45dw2CmDx90Bv/MjtHUYxgnWERI7PME6v/kTXz94OD8hG9yIuuvR6R5N20V02sD0NkKbHr0d4nzzb+uzj79rY8Bx5nlB1luL/FBgLxSkVBCiiFaVJZQqoy2khFQKRyFwOB7j96KQtFdAlB1yqdH2I3hkTFdUFrIZsCwrbo11XS/gPcuybOA1/bJh82fD4LDf7yHpRJ4zdbY2weg9wjxHnI9ck4OQHJb5iRjKklI6oWpalFUdocoqoiB/2xn4aSaELQCSQEkWzDJz44j94UjaiCjqNc2Xad+S4Oy/BJyIYV030FpjpODnTTOlx5rc0/NmQNboVLeYKf9ADKcwR2zz63r0Idp/jUvAEEIshLn01rXHeK7J8qGsHwe8xfAcLBaFfxJU4dhzaus/loD7rqqqaLtO3005bams9ytauiWGNGzaFsz4Xi++mvIyB7QUiBnu8pwYnmJxuOJ/C39vXNvGz8TQ0H3UpBXpR5rxdUxvzXInzRcaagecpMFsJ4CKaKkgjm+Lc/Eh4Plr2j3T8KF5xNvv7/Hm2zt8+PmJgq5UzRD7MDzZ/x0x5YNW+PjwhfAZX4sfz9kk2lzSuoH00fgDLa8toO22i/YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"webhook\"\n        title=\"\"\n        src=\"/static/b7d2a4706547240a810a7cc5f03b27b5/7de01/webhook.png\"\n        srcset=\"/static/b7d2a4706547240a810a7cc5f03b27b5/772e8/webhook.png 200w,\n/static/b7d2a4706547240a810a7cc5f03b27b5/e17e5/webhook.png 400w,\n/static/b7d2a4706547240a810a7cc5f03b27b5/7de01/webhook.png 794w\"\n        sizes=\"(max-width: 794px) 100vw, 794px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>item 으로 등록한 브랜치에 푸쉬 하고 정상적으로 item 이 실행되는지 확인한다.</li>\n<li>Recent Deliveries 탭을 선택해서 실행된 webhook 들의 상태를 확인 할 수 있다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1ca2bc92e64c1eb1825299257ee15b61/d7542/recent-deliveries.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAw0lEQVR42o2QgWrEIAyG+/4POW71egcHK7WeJjHaf0mPwrGNssBHjOhn4nBfFB+PijA3POYV4xgw3e4I4YpPI5cCj23b/sXQWwMToTVFzhkpJTAzjvBDvRtH/sEvYVVFfGYUEsSUEdeEZ2GQqFGhrZ92pNoMtXPtJRQrppVxjYQpCW6pWi0IC+HylbGyno4s9iiz7Ln3joGr/d9SMBou2Ym0713mgkgufBv7DRe6jIjBImgu3Nu2hY/2F37xLLyrA3d9A+bT1gqZR7m+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"recent-deliveries\"\n        title=\"\"\n        src=\"/static/1ca2bc92e64c1eb1825299257ee15b61/5a190/recent-deliveries.png\"\n        srcset=\"/static/1ca2bc92e64c1eb1825299257ee15b61/772e8/recent-deliveries.png 200w,\n/static/1ca2bc92e64c1eb1825299257ee15b61/e17e5/recent-deliveries.png 400w,\n/static/1ca2bc92e64c1eb1825299257ee15b61/5a190/recent-deliveries.png 800w,\n/static/1ca2bc92e64c1eb1825299257ee15b61/d7542/recent-deliveries.png 810w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n</li>\n</ul>\n<br>\n<h3>4. slack 연동</h3>\n<ul>\n<li>설정할 slack 워크스페이스 url/apps 로 접속해서 jenkins 를 검색 후 설치할 채널을 선택하고 설치한다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d065e62af3c1907875fac47f12969ad8/159fb/slack-jenkins-install.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 48.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVR42o1SPU/DMBTM/2RkY4I/w4AQDBUsSAwIFgZYYAGpRXQp/UBNpTbNJyFx8+nksF+aYEIksHR6tnPvdO8czfQZWBTDCyIELEIYBIiiCHEc/wtJkjRVQnsfDqAvFpiMx/A8ryGmafon2mIkOB69Qdd1TKdTzGYzzOdzLJdL2JYNy7Jg2zZM02z2juMIVHebzea3Q0l0XZcIq9WKxAzDgO/7CMMQjDGqKuq7rmg0Jj44jkukoihQlmVT6yX3XZA8FeRwvV6j3+/TqEHwSTlK8ZxzfAiXTIyV8RxZXqEtQuLbKnPVsiwjAXngslGcuRCjxb9dqm5VwThJ4bMYec4rwXZDsR31djLEzsUh9q5OsX/dw+7lEQ5uesgL/oMvJ0kyTn0k2B6hdvdqLHD8dIfzl0fCyfM9zgYPJKC6rLKuMqUM1X+ohnwt0Ymu1cVX8QUtJ/7gnQQyFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"slack-jenkins-install\"\n        title=\"\"\n        src=\"/static/d065e62af3c1907875fac47f12969ad8/5a190/slack-jenkins-install.png\"\n        srcset=\"/static/d065e62af3c1907875fac47f12969ad8/772e8/slack-jenkins-install.png 200w,\n/static/d065e62af3c1907875fac47f12969ad8/e17e5/slack-jenkins-install.png 400w,\n/static/d065e62af3c1907875fac47f12969ad8/5a190/slack-jenkins-install.png 800w,\n/static/d065e62af3c1907875fac47f12969ad8/159fb/slack-jenkins-install.png 1019w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>Jenkins CI 통합 앱 추가 버튼 선택 시 나오는 설정 지침의 <strong>3 단계에서 팀 하위 도메인(Team Domain), 통합 토큰 자격 증명 ID(Integration Token) 를 별도로 복사해둔다.</strong>(젠킨스 설정에 사용)</li>\n<li>젠킨스에서 젠킨스 관리 - 플러그인 관리 - 설치 가능 페이지에서 slack 을 검색해서 설치한다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b8a003926a03fae3af213e10a13a130f/29229/slack-notification.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 20.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvklEQVR42qXQzQqCQBQF4HnjVu16jpb9QJSWlWlZFEJFVkph0CqCqFZh1FKaGfU0Giatu/AxnGEWcw9hjCGWThAE+GfI+XJFfziBtbRRqtaRyxegG2OMzRnM6QJza421s8XK3mRETu+cjfvl7vYgh+MJzY6GiqyiWG6gJilotnuC9tXqZOIsKz3I4o2kqOhqBlR9KBjQBiMQKjaMxFdvnof74wnf98XaXNRAE5wzcPYR5zD8rSSKwuSk9JXU9Qb56RykzB0vwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"slack-notification\"\n        title=\"\"\n        src=\"/static/b8a003926a03fae3af213e10a13a130f/5a190/slack-notification.png\"\n        srcset=\"/static/b8a003926a03fae3af213e10a13a130f/772e8/slack-notification.png 200w,\n/static/b8a003926a03fae3af213e10a13a130f/e17e5/slack-notification.png 400w,\n/static/b8a003926a03fae3af213e10a13a130f/5a190/slack-notification.png 800w,\n/static/b8a003926a03fae3af213e10a13a130f/29229/slack-notification.png 1167w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>메인 페이지의 젠킨스 관리 - 시스템 설정으로 이동</li>\n<li>\n<p>Slack 메뉴에서 slack 에서 복사한 팀 하위 도메인, 통합 토큰을 입력한다.</p>\n<ul>\n<li>Workspace 에는 팀 하위 도메인 입력</li>\n<li>Default channel / member id 는 slack 웹사이트 상에서 선택한 jenkins 알람을 받을 채널명\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/021192ec8adfe9ca5dc6e18a9f5b4b3a/4dba2/jenkins-slack-conf.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 37%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjklEQVR42p1Ryw7DIAzL/38qoyBoSikvL+lj2m0aliw4BMc2ZIxBzhljDPTepykC4FxA1lqEEKDorU2JNeEQrukAqRhvGzila9MExn3upYG891AuzuEo5RoQ+/9ScUZWh0rtsYjgVGSpSiPvpYJqrWBmxBhP0RmHzxu3JtDzw58+vu4/u7tn1aF5LVKbxxu4mCi2txAyxgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"jenkins-slack-conf\"\n        title=\"\"\n        src=\"/static/021192ec8adfe9ca5dc6e18a9f5b4b3a/5a190/jenkins-slack-conf.png\"\n        srcset=\"/static/021192ec8adfe9ca5dc6e18a9f5b4b3a/772e8/jenkins-slack-conf.png 200w,\n/static/021192ec8adfe9ca5dc6e18a9f5b4b3a/e17e5/jenkins-slack-conf.png 400w,\n/static/021192ec8adfe9ca5dc6e18a9f5b4b3a/5a190/jenkins-slack-conf.png 800w,\n/static/021192ec8adfe9ca5dc6e18a9f5b4b3a/4dba2/jenkins-slack-conf.png 1151w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>Credential</li>\n<li>kind: Secret text</li>\n<li>Secret: 통합 토큰 자격 증명</li>\n<li>ID: 식별자이기 때문에 원하는 이름을 적는다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8aa8d31e2c881c2cc29905e4a05b9e3a/0d6fe/slack-credential.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6UlEQVR42qWS2Q6CQAxF5/8/TWSPPigaNYCyDMOwPl5bIgaNRIkPJ03oTDm3IDZbH5ZtEw5cz4OxNrE2TTiuC8uy4fk+VoaB0/mCKL4ijOIZIsTUF8HhiCDYY7fbUw1QliW01kOdopT6CRGGIdI0RZIkyLIMXdd9pO/7eR79pq4heBAb8KW2bYfG3NBvaF1BsJWUEjVN56gjS4b3j3rNKTLHZYqieNlF0zRP61/gsywl8jwfDNlqupelcVtCjZGrqhoesNUUfvNY55ieu0mKnFFcNvznY4yGN1lCFIr+M1Llyjt4t1wC378DjL/60EtvGUAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"slack-credential\"\n        title=\"\"\n        src=\"/static/8aa8d31e2c881c2cc29905e4a05b9e3a/5a190/slack-credential.png\"\n        srcset=\"/static/8aa8d31e2c881c2cc29905e4a05b9e3a/772e8/slack-credential.png 200w,\n/static/8aa8d31e2c881c2cc29905e4a05b9e3a/e17e5/slack-credential.png 400w,\n/static/8aa8d31e2c881c2cc29905e4a05b9e3a/5a190/slack-credential.png 800w,\n/static/8aa8d31e2c881c2cc29905e4a05b9e3a/0d6fe/slack-credential.png 1115w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n</li>\n<li>Test Connection 을 선택해서 성공하면 slack 채널에 다음과 같은 메시지가 나타난다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/23279b9bf2683fc7eab8cfa227f33f2c/bb9c5/slack-jenkins-test.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 521px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjUlEQVR42pWOzQrCMBCE8/4PIXj3fWqJIHXVmrZppTX/MWOSg+DRgdmP2cMwTG0riDcYhEDXdViWJ4wxsNbiX6WUwAYiHPY7tNcz2uYIzk+g/CO6VEopMY4jhBgwZT7kitus0M8v3LNp2tAvqpYVsXJ8tnkHxBjhnKsuC7XWP7nSBRgXYXxhgC7Zx2/hB+Z95pcYJrjWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"slack-jenkins-test\"\n        title=\"\"\n        src=\"/static/23279b9bf2683fc7eab8cfa227f33f2c/bb9c5/slack-jenkins-test.png\"\n        srcset=\"/static/23279b9bf2683fc7eab8cfa227f33f2c/772e8/slack-jenkins-test.png 200w,\n/static/23279b9bf2683fc7eab8cfa227f33f2c/e17e5/slack-jenkins-test.png 400w,\n/static/23279b9bf2683fc7eab8cfa227f33f2c/bb9c5/slack-jenkins-test.png 521w\"\n        sizes=\"(max-width: 521px) 100vw, 521px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>젠킨스에서 일반적인 아이템으로 만들었을 경우에는 빌드 후 조치 메뉴에서 slack 알림 설정이 손쉽게 가능하지만 pipeline 을 선택할 경우에는 Jenkinsfile 에 별도로 작성해야 한다.</li>\n<li>그런 불편함에도 pipeline 으로 아이템을 생성하는 이유는 Jenkinsfile 로 빌드 - 테스트 - 도커라이징 - 배포로 이어지는 과정을 Jenkinsfile 을 통해 코드로 관리 할 수 있기 때문이라고 생각한다.</li>\n</ul>\n<br>\n<h3>5. Dockerfile 작성하기</h3>\n<ul>\n<li>\n<p>springBoot 2.3 부터 gradle 에서 bootBuildImage 라는 task 로 Dockerfile 없이 docker image 생성이 가능하다.</p>\n<ul>\n<li>하지만 docker image 의 이름을 변경하는 것 정도의 설정 말고는 별도의 custom 이 불가능하다.</li>\n</ul>\n</li>\n<li>\n<p>별도의 Dockerfile 들을 작성하는 이유</p>\n<ul>\n<li>docker-compose 로 db, springBoot app 모든 것들을 한번에 띄우려고 했지만 db container 가 뜨기 전에 springBoot app 이 실행 되면서 db connection 이 되지 않는 문제 발생.</li>\n<li>위의 문제를 해결하기 위해 dockerize 로 db container 가 실행 된 후 실행하려 했지만 bootBuildImage 로 만든 이미지는 커스텀 설정이 불가능한 것 같다.</li>\n</ul>\n</li>\n<li>\n<p>Dockerfile 에 넣기 위해 build.gradle 설정하기</p>\n<ul>\n<li>build 할 때 lib 부분과 application 부분을 분리해서 빌드한다.</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"properties\"><pre class=\"language-properties\"><code class=\"language-properties\"><span class=\"token attr-name\">//라이브러리</span> <span class=\"token attr-value\">디렉토리 분리</span>\n<span class=\"token attr-name\">task</span> <span class=\"token attr-value\">moveLib {</span>\n<span class=\"token attr-name\">  doLast</span> <span class=\"token attr-value\">{</span>\n<span class=\"token attr-name\">      def</span> <span class=\"token attr-value\">unpackDir = \"$buildDir/unpack\"</span>\n<span class=\"token attr-name\">      copy</span> <span class=\"token attr-value\">{</span>\n<span class=\"token attr-name\">          from</span> <span class=\"token attr-value\">file(\"${unpackDir}/app/BOOT-INF/lib\")</span>\n<span class=\"token attr-name\">          into</span> <span class=\"token attr-value\">file(\"${unpackDir}/lib\")</span>\n      }\n  }\n}\n<span class=\"token attr-name\">//jar</span> <span class=\"token attr-value\">파일을 복사해서 unpack/app 디렉토리로 이동</span>\n<span class=\"token attr-name\">task</span> <span class=\"token attr-value\">unpackJar(type: Copy) {</span>\n<span class=\"token attr-name\">  def</span> <span class=\"token attr-value\">unpackDir = \"$buildDir/unpack\"</span>\n\n<span class=\"token attr-name\">      delete</span> <span class=\"token attr-value\">unpackDir</span>\n<span class=\"token attr-name\">      from</span> <span class=\"token attr-value\">zipTree(bootJar.getArchiveFile())</span>\n<span class=\"token attr-name\">      into</span> <span class=\"token attr-value\">\"$unpackDir/app\"</span>\n\n<span class=\"token attr-name\">      finalizedBy</span> <span class=\"token attr-value\">moveLib</span>\n }\n\n<span class=\"token attr-name\">build</span> <span class=\"token attr-value\">{</span>\n<span class=\"token attr-name\">    finalizedBy</span> <span class=\"token attr-value\">unpackJar</span>\n}</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>docker image 만들기</p>\n<ul>\n<li>하나의 Dockerfile 로 태그명과 copy 하는 데이터만 다르게 해서 springBoot app 들의 이미지를 만들 수도 있을거 같은데.. 각 서비스에서 별도의 설정이 필요할까봐 일단 각각의 서비스별로 Dockerfile 작성</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> openjdk:11-jre-slim</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> DOCKERIZE_VERSION v0.6.1</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> DB_CONTAINER_NAME db</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apt-get update -y &amp;&amp; apt-get install -y wget &amp;&amp; <span class=\"token operator\">\\</span>\nwget https://github.com/jwilder/dockerize/releases/download/<span class=\"token variable\">$DOCKERIZE_VERSION</span>/dockerize-alpine-linux-amd64-<span class=\"token variable\">$DOCKERIZE_VERSION</span>.tar.gz <span class=\"token operator\">\\</span>\n&amp;&amp; tar -C /usr/local/bin -xzvf dockerize-alpine-linux-amd64-<span class=\"token variable\">$DOCKERIZE_VERSION</span>.tar.gz <span class=\"token operator\">\\</span>\n&amp;&amp; rm dockerize-alpine-linux-amd64-<span class=\"token variable\">$DOCKERIZE_VERSION</span>.tar.gz</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> /root</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ARG</span> buildDir=build/unpack</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> <span class=\"token variable\">${buildDir}</span>/lib BOOT-INF/lib</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> <span class=\"token variable\">${buildDir}</span>/app .</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> dockerize -wait tcp://<span class=\"token variable\">$DB_CONTAINER_NAME</span>:3306 -timeout 10s java -Dspring.profiles.active=<span class=\"token variable\">${USER_PROFILE}</span> org.springframework.boot.loader.JarLauncher</span></code></pre></div>\n</li>\n<li>DB_CONTAINER_NAME: springBoot app 이 db container 보다 먼저 실행되는것을 막기 위해 CMD 에서 dockerize 명령으로 wait 할 db 컨테이너명을 적어준다.</li>\n<li>USER_PROFILE: docker-compose 파일을 통해 환경변수로 받는 active profile 명이다.</li>\n<li>\n<p>COPY 를 2개로 분리하는 이유</p>\n<ul>\n<li>Dockerfile 을 만드는 과정에서 레이어를  생성하는데 COPY 하나당 하나의 레이어가 생성된다.</li>\n<li>레이어는 도커 이미지를 만들 때 재사용이 가능한데 이렇게 app 영역과 lib 영역을 나누면 도커 이미지를 만드는 과정에서 캐시된 레이어를 재사용 할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>Dockerfile 작성 순서</p>\n<ul>\n<li>Dockerfile 을 위와 같은 순서로 작성한 이유는 일단 한 번 캐싱을 사용할 수 없는 구간이 발생하면, in order 로 진행되는 Docker 의 빌드 특성상 그 아래 모든 레이어는 캐싱을 사용할 수 없기 때문이다.</li>\n<li>만약 dockerize 를 다운받는 RUN 구문이 COPY 다음에 있고, 소스 코드의 변경이 발생한다면 COPY ${buildDir}/app . 부분에서 변경이 발생해서 캐시된 레이어를 사용하지 않고, 그 다음 RUN 구문에서도 캐시를\n사용하지 않게 된다.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<br>\n<h3>6. docker-compose file 작성하기</h3>\n<ul>\n<li>docker-compose file 은 로컬 개발환경용과 배포할 개발서버용을 따로 만들어서 사용했다. 로컬에서는 db, flyway 등 개발에 필요한 환경 구성용이고,\n개발환경용은 개발에 필요한 환경과 springBoot app 을 컨테이너로 실행하는 환경까지 포함하고 있다.</li>\n<li>\n<p>.env</p>\n<ul>\n<li>\n<p>docker-compose 파일에서 사용할 환경변수 목록</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">USER_PROFILE_DEVELOP</span><span class=\"token operator\">=</span>dev\n<span class=\"token assign-left variable\">USER_PROFILE_PRODUCT</span><span class=\"token operator\">=</span>prod</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>docker-compose-dev.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">db</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> maria<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mariadb<span class=\"token punctuation\">:</span>10.6.4\n  <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> MARIADB_DATABASE=spring\n    <span class=\"token punctuation\">-</span> MARIADB_ALLOW_EMPTY_ROOT_PASSWORD=yes\n    <span class=\"token punctuation\">-</span> TZ=Asia/Seoul\n    <span class=\"token punctuation\">-</span> LANG=C.UTF<span class=\"token punctuation\">-</span><span class=\"token number\">8</span>\n  <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>character<span class=\"token punctuation\">-</span>set<span class=\"token punctuation\">-</span>server=utf8mb4 <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>collation<span class=\"token punctuation\">-</span>server=utf8mb4_unicode_ci\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3306:3306\"</span>\n<span class=\"token key atrule\">migration</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> flyway/flyway<span class=\"token punctuation\">:</span>8.0.4\n  <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span>configFiles=/flyway/conf/flyway.config <span class=\"token punctuation\">-</span>connectRetries=60 migrate\n  <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ./flyway/migration/main<span class=\"token punctuation\">:</span>/flyway/main\n    <span class=\"token punctuation\">-</span> ./flyway/conf/develop.conf<span class=\"token punctuation\">:</span>/flyway/conf/flyway.config\n  <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> db\n<span class=\"token key atrule\">admin</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> app<span class=\"token punctuation\">-</span>admin\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./admin\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> app<span class=\"token punctuation\">-</span>admin\n  <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> USER_PROFILE=$<span class=\"token punctuation\">{</span>USER_PROFILE_DEVELOP<span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> db\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"9090:8080\"</span>\n<span class=\"token key atrule\">user</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> app<span class=\"token punctuation\">-</span>user\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./user\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> app<span class=\"token punctuation\">-</span>user\n  <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> USER_PROFILE=$<span class=\"token punctuation\">{</span>USER_PROFILE_DEVELOP<span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> db\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8081:8080\"</span></code></pre></div>\n</li>\n<li>\n<p>flyway 설정</p>\n<ul>\n<li>로컬 개발환경에서는 버전관리하는 스크립트와 반복적으로 실행될 seed 를 모두 migration 해주고, 개발 환경에서는 버전관리용 스크립트만 실행하도록 했다.</li>\n<li>위의 docker-compose-dev 파일에서는 별도로 분리한 conf 파일중 develop.conf 파일을 사용하도록 했다.</li>\n<li>로컬(local.conf)</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">flyway.url<span class=\"token operator\">=</span>jdbc:mariadb://db:3306/spring\nflyway.user<span class=\"token operator\">=</span>root\nflyway.password<span class=\"token operator\">=</span>\nflyway.locations<span class=\"token operator\">=</span>filesystem:/flyway/main,filesystem:/flyway/seed</code></pre></div>\n</li>\n<li>개발환경(develop.conf)</li>\n<li>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">flyway.url<span class=\"token operator\">=</span>jdbc:mariadb://db:3306/spring\nflyway.user<span class=\"token operator\">=</span>root\nflyway.password<span class=\"token operator\">=</span>\nflyway.locations<span class=\"token operator\">=</span>filesystem:/flyway/main</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>springBoot profile 설정</p>\n<ul>\n<li>개발환경에서는 db 와 springBoot app 이 docker compose 로 같이 실행되면서 같은 네트워크를 사용하게 된다. 이때 <strong>springBoot app 에서는 db connection 을 localhost 가 아닌\ndb 의 서비스명을 적어줘야 한다.</strong></li>\n<li>그래서 다음과 같이 local 과 dev 환경의 profile 을 분리했다.</li>\n<li>\n<p>local</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">profiles</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">group</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">\"dev\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"dev\"</span>\n<span class=\"token key atrule\">datasource</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">driver-class-name</span><span class=\"token punctuation\">:</span> org.mariadb.jdbc.Driver\n <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> jdbc<span class=\"token punctuation\">:</span>mariadb<span class=\"token punctuation\">:</span>//localhost<span class=\"token punctuation\">:</span>3306/spring\n <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> root\n <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">hikari</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">maximum-pool-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\n   <span class=\"token key atrule\">minimum-idle</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span></code></pre></div>\n</li>\n<li>\n<p>dev</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">datasource</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">driver-class-name</span><span class=\"token punctuation\">:</span> org.mariadb.jdbc.Driver\n <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> jdbc<span class=\"token punctuation\">:</span>mariadb<span class=\"token punctuation\">:</span>//db<span class=\"token punctuation\">:</span>3306/spring\n <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> root\n <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">hikari</span><span class=\"token punctuation\">:</span>\n   <span class=\"token key atrule\">maximum-pool-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\n   <span class=\"token key atrule\">minimum-idle</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>로컬에서 build &#x26; docker-compose 실행</p>\n<ul>\n<li>Jenkinsfile 을 작성하기전에 로컬에서 docker-compose file 이 잘 실행되는지 테스트 한다.(프로젝트 root 경로에서 실행)</li>\n<li>\n<p>window 환경이라면 ./gradlew 가 아니라 gradlew.bat 파일로 실행해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">docker-compose -f docker-compose-dev.yml up -d db migration\n./gradlew clean build\ndocker-compose -f docker-compose-dev.yml build\ndocker-compose -f docker-compose-dev.yml up -d</code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<br>\n<h3>7. Jenkinsfile 작성하기</h3>\n<ul>\n<li>\n<p>젠킨스의 빌드 기록의 빌드 목록중에서 화살표를 눌러 Replay 를 선택해서 아래의 스크립트를 넣어서 실행시켜 본다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8b037d78f519e47c2e33c3fbd2d57995/5f6dd/jenkins-replay.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 57.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrUlEQVR42o1Si27TUAy9//8/QLd2HQKtgg2hbl3ZmtKkeXTJ1rzLbt452F47QBowS0fH8fH1tW+ssiSE1hpt26Lve1SlRkqxJEkQhiGiKEJd12Bj/X9Q3p0HXZSomlaQ5zkc24JpWvA8T8BFsyxDmqbY7XbCL4HPKs+/R3D/gN2jRt12iJMU6/Uatm0L2DdN8xmWZQmvVivxmQ/frutChdutjNfRyGx802KxwHK5hGEshV8DwzDgOA5UHMcoiwJd1z0VzHLpzHUdSWB2D0wdOHvtD519ige+D3UXPCChrqr9w3sbH28HQxyNxhidnOJ4dIrBcIzB8YlgOH4vsXdHI8rZ6xR/Q2c+nX/hNwwQxikeiwpFVWMTbDG5mGI2v8WH80ucfb7A1+kVLmffBLP5Da5JY55eXVNsLvg4mcC0bKgNFYzTXAr+0KVA10/jVz0QR1v6wyleMpKxT0WuC2HF4za0Ll3Xo6V37H4DWxHRBlBB/mkca2gTasov60Z85lpWjrUWqmka/M24g8Vqg1vLR5xpvMZUVVWy4Xz7gX/5PW7WAWbffYRp8Rzr/sE/AfYIOj1dbGS3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"jenkins-replay\"\n        title=\"\"\n        src=\"/static/8b037d78f519e47c2e33c3fbd2d57995/5a190/jenkins-replay.png\"\n        srcset=\"/static/8b037d78f519e47c2e33c3fbd2d57995/772e8/jenkins-replay.png 200w,\n/static/8b037d78f519e47c2e33c3fbd2d57995/e17e5/jenkins-replay.png 400w,\n/static/8b037d78f519e47c2e33c3fbd2d57995/5a190/jenkins-replay.png 800w,\n/static/8b037d78f519e47c2e33c3fbd2d57995/5f6dd/jenkins-replay.png 1139w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">pipeline <span class=\"token punctuation\">{</span>\nagent any\nstages <span class=\"token punctuation\">{</span>\n    stage<span class=\"token punctuation\">(</span><span class=\"token string\">'Gradle test'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        steps <span class=\"token punctuation\">{</span>\n            script <span class=\"token punctuation\">{</span>\n                try <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'chmod 755 ./gradlew'</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'docker-compose -f docker-compose-dev.yml down'</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'docker-compose -f docker-compose-dev.yml up -d db migration'</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'./gradlew clean build'</span>\n                <span class=\"token punctuation\">}</span> catch <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'echo Gradle test Fail!!!'</span>\n                    slackSend <span class=\"token punctuation\">(</span>channel: <span class=\"token string\">'#jenkins-test'</span>, color: <span class=\"token string\">'#FF0000'</span>, message: <span class=\"token string\">\"FAILED: Job '<span class=\"token variable\">${env.JOB_NAME}</span> [<span class=\"token variable\">${env.BUILD_NUMBER}</span>]' (<span class=\"token variable\">${env.BUILD_URL}</span>)\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    stage<span class=\"token punctuation\">(</span><span class=\"token string\">'Dockerfile build'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        steps <span class=\"token punctuation\">{</span>\n            script <span class=\"token punctuation\">{</span>\n                try <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'docker-compose -f docker-compose-dev.yml build'</span>\n                <span class=\"token punctuation\">}</span> catch <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'echo Dockerfile build Fail!!!'</span>\n                    slackSend <span class=\"token punctuation\">(</span>channel: <span class=\"token string\">'#jenkins-test'</span>, color: <span class=\"token string\">'#FF0000'</span>, message: <span class=\"token string\">\"FAILED: Job '<span class=\"token variable\">${env.JOB_NAME}</span> [<span class=\"token variable\">${env.BUILD_NUMBER}</span>]' (<span class=\"token variable\">${env.BUILD_URL}</span>)\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    stage<span class=\"token punctuation\">(</span><span class=\"token string\">'Docker-compose'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        steps <span class=\"token punctuation\">{</span>\n            script <span class=\"token punctuation\">{</span>\n                try <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'docker-compose -f docker-compose-dev.yml up -d'</span>\n                    slackSend <span class=\"token punctuation\">(</span>channel: <span class=\"token string\">'#jenkins-test'</span>, color: <span class=\"token string\">'#00FF00'</span>, message: <span class=\"token string\">\"SUCCESSFUL: Job '<span class=\"token variable\">${env.JOB_NAME}</span> [<span class=\"token variable\">${env.BUILD_NUMBER}</span>]' (<span class=\"token variable\">${env.BUILD_URL}</span>)\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span> catch <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token function\">sh</span> <span class=\"token string\">'echo Docker-compose Fail!!!'</span>\n                    slackSend <span class=\"token punctuation\">(</span>channel: <span class=\"token string\">'#jenkins-test'</span>, color: <span class=\"token string\">'#FF0000'</span>, message: <span class=\"token string\">\"FAILED: Job '<span class=\"token variable\">${env.JOB_NAME}</span> [<span class=\"token variable\">${env.BUILD_NUMBER}</span>]' (<span class=\"token variable\">${env.BUILD_URL}</span>)\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>성공했다면 다음과 같은 메시지를 slack 에서 확인 할 수 있다.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aa081ef38ddd3994d6fe98d59cc1775e/442cb/jenkins-success.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 752px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 9.499999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaElEQVR42lWN2wqDQAxE/f8PLEihgr6saOIlyErS3TFbt9AGDoeZh0nz6p7o+wHrskJEoKowM5hbi9/pg9oPNZc+54xyXzft+EAIoxPAzFgccpgI5E9ITrBEzHvEtN+mmrfjRE7pb/AC4J+aosBd22AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"jenkins-success\"\n        title=\"\"\n        src=\"/static/aa081ef38ddd3994d6fe98d59cc1775e/442cb/jenkins-success.png\"\n        srcset=\"/static/aa081ef38ddd3994d6fe98d59cc1775e/772e8/jenkins-success.png 200w,\n/static/aa081ef38ddd3994d6fe98d59cc1775e/e17e5/jenkins-success.png 400w,\n/static/aa081ef38ddd3994d6fe98d59cc1775e/442cb/jenkins-success.png 752w\"\n        sizes=\"(max-width: 752px) 100vw, 752px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n</ul>\n<br>\n<h3>8. 테스트</h3>\n<ul>\n<li>위에서 테스트에 성공한 스크립트를 github 저장소의 Jenkinsfile 에 추가해서 커밋 &#x26; 푸쉬한다.</li>\n<li>repository webhook 확인\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8566673d58873504de49fe213131116f/64d87/test-webhook.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 33.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA00lEQVR42pWR3W6DMAxGef9X3MUKpLAfUiAhcUxIvsUpvduq1dKRYis6+iw3b5+MTkd8zQ5KKXS9wnUY8X5pMekbpHLO/6ahwOA9wnvC5hzs5hDjgeMQ0kuyKjR2wx4jjLVYVlOFWVLVZHhRCDSjDehnj+tKGC1jMNI7tNriw9BTqWwhmwmB+Z5wWH0VCCJVi69cpocwPxfSKQynUBVJtxD6VQgnhLakHkta+ZR+4SEkCqAQyh32u/DmGNMWKrq89dl/F2bPf15ZKqUELqsKsdxB5j80DyLhUNdQ4AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"test-webhook\"\n        title=\"\"\n        src=\"/static/8566673d58873504de49fe213131116f/5a190/test-webhook.png\"\n        srcset=\"/static/8566673d58873504de49fe213131116f/772e8/test-webhook.png 200w,\n/static/8566673d58873504de49fe213131116f/e17e5/test-webhook.png 400w,\n/static/8566673d58873504de49fe213131116f/5a190/test-webhook.png 800w,\n/static/8566673d58873504de49fe213131116f/64d87/test-webhook.png 818w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>jenkins 빌드기록 확인\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d902bb3aaab1d51816203053f2ccdeb5/fe9e8/test-jenkins-build.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 64.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACNklEQVR42oVTi26cMBDk/z8uUdO7cgfh/cZgDOZhDNx0cZS2SZV2pZV2V2I8sztYtyhAy1uwlkOtGqvesB8H0jSFbduIogi+78NxHOR5gTMejwe+CuubE6AhMLkoyHmBnBaMVG+bxqY1HsdO9QZN9b7vvwC/SssLfXTE8POr8yTAuxZiOaD3479AvwGDGMs84/hjeEZVVYjjhFbR/VPiX5LTMIHgHMuyfNhP3w/EnBPTyfRqVcjyDBP1+76ZnJcZcpRmHaIXZiVWnGUQXYd1XT/Ieo9zPpOCXvRw7g5Y3aBhHXgrUJc14jDGQI+zipFSBevuh+C8g/rEcJgUyrJCGAYQQqDqaniVh7hN4LEUYZsh4QkCFiIXOQpZgE8dMSTbSCkxDPLDLpZ1I7sEuDt30zPFcBtvCFSAeItM+osPd3YR6RjREYHtDSzb9REmGaqGQ4wzSkae5IIspGgvPcZpNIDN2sKRDsIlhDd6lPSdonr2kOgU6SNFu7ewHPcVHUlq25Zs0pk8gYScUDNm5lpp5EOOC7/A6R0D+Ep5E3dc+Q/Tu5OLcikJMPCMbeq6RtM05lJn8l6iollRFBjlSDuL8FQ84cIuuBPoncBe6hc8F8+w+Q3f2wvSMYN181xM40QHKMGI0flXnCnkTOw42ac3kuulxrW/4nXyEKwBwjWEO7qwe/tN+uqh1jUZOwrpwspI60juO8OD/ufTm0qpt6uvEsVUGOBGk3XWBtVcoZyJiGrANMOgB/wERYzgScXByD8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"test-jenkins-build\"\n        title=\"\"\n        src=\"/static/d902bb3aaab1d51816203053f2ccdeb5/5a190/test-jenkins-build.png\"\n        srcset=\"/static/d902bb3aaab1d51816203053f2ccdeb5/772e8/test-jenkins-build.png 200w,\n/static/d902bb3aaab1d51816203053f2ccdeb5/e17e5/test-jenkins-build.png 400w,\n/static/d902bb3aaab1d51816203053f2ccdeb5/5a190/test-jenkins-build.png 800w,\n/static/d902bb3aaab1d51816203053f2ccdeb5/fe9e8/test-jenkins-build.png 1146w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </li>\n<li>slack 채널 메시지 확인</li>\n<li>\n<p>docker-compose 파일에 설정한 springBoot app 이 정상적으로 실행되었는지 확인</p>\n<ul>\n<li><a href=\"http://localhost:9090/admin\">http://localhost:9090/admin</a> , <a href=\"http://localhost:8081/user\">http://localhost:8081/user</a> 2개의 요청이 정상적인 값을 리턴하는지 확인</li>\n</ul>\n</li>\n</ul>\n<h3>TODO</h3>\n<ul>\n<li>\n<p>jenkins, slack, docker 를 이용해서 기본적인 빌드 &#x26; 배포 과정을 테스트 해보았지만 아래와 같은 것들을 더 공부해봐야 할 것 같다.</p>\n<ul>\n<li>gradle build test 를 위한 별도의 db 컨테이너 사용하기</li>\n<li>서비스를 중단하지 않고, 무중단 배포하기</li>\n<li>springBoot app 이 정상적으로 실행되었는지 Jenkinsfile 에서 확인후 slack 으로 알림</li>\n<li>배포가 실패할 경우 브랜치에 푸쉬한 사람을 특정해서 slack 또는 메일 알림 보내주기</li>\n<li>docker build 후에 사용하지 않는 도커 레이어들을 정리하기</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/jenkins-build-deploy/","prefix":"2021-11-15"},"frontmatter":{"title":"jenkins 를 이용한 빌드 & 배포","category":"infra"}},"authornote":{"id":"265dda60-7971-5464-926f-ea569c79ac0a","html":"<p>🔘 안되면 될 때 까지! 🏃 🔘</p>"}},"pageContext":{"slug":"/jenkins-build-deploy/","prev":{"id":"85cc4f0d-429c-5cdc-af37-cee54cf5c246","fields":{"slug":"/toby-spring-vol1-ch2/","prefix":"2021-04-25","source":"posts"},"frontmatter":{"title":"토비의 스프링 3.1(vol1) - 2장 테스트","category":"toby-spring"}},"next":{"id":"7c5addd0-a3c6-5f1d-9739-26543d439303","fields":{"slug":"/intellij-mac-keymap/","prefix":"2021-12-29","source":"posts"},"frontmatter":{"title":"intellij mac 단축키","category":"ide"}},"source":"posts"}},"staticQueryHashes":["960164547","960164547"]}