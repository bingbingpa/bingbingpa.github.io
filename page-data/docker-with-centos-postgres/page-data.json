{"componentChunkName":"component---src-templates-post-template-js","path":"/docker-with-centos-postgres/","result":{"data":{"post":{"id":"b16cebeb-cc8d-5422-81df-fe3d0f09d800","html":"<ul>\n<li>\n<p>centos 최신 이미지 pull</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker image pull centos</code></pre></div>\n</li>\n<li>\n<p>container 생성</p>\n<ul>\n<li>\n<p>systemctl 을 사용하기 위해서는 privileged 옵션을 사용해야 하고 실행 커맨드는 /sbin/init 를 사용한다. privileged 옵션을 사용하는 것이 보안에는 취약하다고 하지만 개발 환경을 하나의 컨테이너에 담아서 쓰기 위해서 일단 이렇게…</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker container run --privileged  -d -p <span class=\"token number\">15432</span>:5432  --name <span class=\"token string\">\"postgres\"</span> centos /sbin/init</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>컨테이너 접속?</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker <span class=\"token builtin class-name\">exec</span> -it postgres /bin/bash</code></pre></div>\n</li>\n<li>\n<p>업데이트 : centos8 부터는 yum 대신 dnf를 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf -y update</code></pre></div>\n</li>\n<li>\n<p>centos docker 컨테이너에서 clear가 안되서 가능하도록 패키지 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf <span class=\"token function\">install</span> ncurses</code></pre></div>\n</li>\n<li>\n<p>저장소 추가 후 postgresql 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf -y <span class=\"token function\">install</span> https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf -y module disable postgresql</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf -y <span class=\"token function\">install</span> postgresql12 postgresql12-server</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf -y <span class=\"token function\">install</span> epel-release yum-utils</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf config-manager --enable pgdg12</code></pre></div>\n</li>\n<li>\n<p>db init : 필요에 따라 initdb 할 때 인코딩과 data 경로를 설정 할 수도 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/usr/pgsql-12/bin/postgresql-12-setup initdb</code></pre></div>\n</li>\n<li>\n<p>container 시작 시 자동 시작 되도록 설정</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">systemctl <span class=\"token builtin class-name\">enable</span> postgresql-12</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">systemctl start postgresql-12</code></pre></div>\n</li>\n<li>\n<p>postgis 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf -y <span class=\"token function\">install</span> https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf config-manager --set-enabled PowerTools</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dnf -y <span class=\"token function\">install</span> postgis30_12</code></pre></div>\n</li>\n<li>\n<p>설치 후 postgres 로 사용자 변경후 psql 로 접속해서 postgis 가 정상 설치되는지 확인</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">su</span> posgres\npsql -U postgres</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> extension postgis<span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>","fields":{"slug":"/docker-with-centos-postgres/","prefix":"2020-04-26"},"frontmatter":{"title":"centos8 postgresql12&postgis 설치하기","category":"database"}},"authornote":{"id":"8b2419cd-9b30-5409-9d2c-da10779777d4","html":"<p><strong>OpenSesame</strong></p>\n<ul>\n<li>안되면 될 때 까지!</li>\n<li>무분별한 정보 보다는 정확한 정보를 전달하도록 노력하기.</li>\n</ul>"}},"pageContext":{"slug":"/docker-with-centos-postgres/","prev":{"id":"18bd5ceb-d76c-5699-8d4c-f92e2a7f734c","fields":{"slug":"/intellij-jsp/","prefix":"2020-04-24","source":"posts"},"frontmatter":{"title":"intellij JSP 관련 오류 해결 방법","category":"ide"}},"next":{"id":"b3425e50-0180-5add-9637-4e1fd715bc53","fields":{"slug":"/postgresql-high-availability/","prefix":"2020-05-31","source":"posts"},"frontmatter":{"title":"postgreSQL 고가용성","category":"databse"}},"source":"posts"}},"staticQueryHashes":["960164547","960164547"]}